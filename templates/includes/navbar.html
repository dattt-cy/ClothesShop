{% load static %} {% load i18n %}

<style>
    .section-header {
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
    }

    .navbar {
        background: #f8f9fa;
        padding: 8px 0;
    }

    .navbar .nav-link {
        color: #495057;
        font-size: 0.9rem;
        padding: 8px 12px;
        transition: color 0.2s;
    }

    .navbar .nav-link:hover {
        color: #28a745;
    }

    .navbar .nav-link i {
        margin-right: 5px;
    }

    .header-main {
        background: white;
        padding: 15px 0;
    }

    .logo {
        max-height: 50px;
        transition: transform 0.2s;
    }

    .logo:hover {
        transform: scale(1.05);
    }

    .btn-primary {
        background: #28a745;
        border-color: #28a745;
        font-weight: 500;
        transition: all 0.2s;
    }

    .btn-primary:hover {
        background: #218838;
        border-color: #218838;
        box-shadow: 0 2px 8px rgba(40, 167, 69, 0.3);
    }

    .btn-outline-primary {
        color: #28a745;
        border-color: #28a745;
        font-weight: 500;
        transition: all 0.2s;
    }

    .btn-outline-primary:hover {
        background: #28a745;
        border-color: #28a745;
        color: white;
    }

    .search .form-control {
        border: 2px solid #e9ecef;
        border-radius: 4px 0 0 4px;
        transition: border-color 0.2s;
    }

    .search .form-control:focus {
        border-color: #28a745;
        box-shadow: none;
    }

    .search .btn-primary {
        border-radius: 0 4px 4px 0;
    }

    .widget-header .title {
        font-size: 0.85rem;
        display: block;
        margin-bottom: 3px;
    }

    .widget-header a {
        color: #495057;
        font-weight: 500;
        text-decoration: none;
        transition: color 0.2s;
    }

    .widget-header a:hover {
        color: #28a745;
    }

    .widget-header .icon {
        background: #f8f9fa;
        border-color: #dee2e6 !important;
        width: 40px;
        height: 40px;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.2s;
    }

    .widget-header .icon:hover {
        background: #28a745;
        border-color: #28a745 !important;
        color: white;
    }

    .badge-danger {
        background: #dc3545;
        position: absolute;
        top: -5px;
        right: -5px;
        min-width: 20px;
        height: 20px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 0.7rem;
    }

    .category-wrap .dropdown-menu {
        border: 2px solid #e9ecef;
        border-radius: 4px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    }

    .category-wrap .dropdown-item {
        padding: 10px 20px;
        transition: all 0.2s;
    }

    .category-wrap .dropdown-item:hover {
        background: #f8f9fa;
        color: #28a745;
        padding-left: 25px;
    }
</style>

<header class="section-header">
    <nav class="navbar p-md-0 navbar-expand-sm navbar-light border-bottom">
        <div class="container">
            <button
                class="navbar-toggler"
                type="button"
                data-toggle="collapse"
                data-target="#navbarTop4"
                aria-controls="navbarNav"
                aria-expanded="false"
                aria-label="Toggle navigation"
            >
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarTop4">
                <ul class="navbar-nav mr-auto">
                    <li class="nav-item dropdown">
                        <a
                            href="#"
                            class="nav-link dropdown-toggle"
                            data-toggle="dropdown"
                        >
                            <i class="fa fa-globe"></i>
                            {% get_current_language as LANGUAGE_CODE %} {% if LANGUAGE_CODE == 'ja' %} 日本語 {% elif LANGUAGE_CODE == 'vi' %} Tiếng Việt {% else %} English {% endif %}
                        </a>
                        <ul class="dropdown-menu small">
                            <li>
                                <form
                                    action="{% url 'set_language' %}"
                                    method="post"
                                    style="display: inline"
                                >
                                    {% csrf_token %}
                                    <input
                                        name="next"
                                        type="hidden"
                                        value="{{ request.get_full_path }}"
                                    />
                                    <input
                                        type="hidden"
                                        name="language"
                                        value="en"
                                    />
                                    <button
                                        type="submit"
                                        class="dropdown-item"
                                        style="
                                            border: none;
                                            background: none;
                                            text-align: left;
                                            width: 100%;
                                            cursor: pointer;
                                        "
                                    >
                                        English
                                    </button>
                                </form>
                            </li>
                            <li>
                                <form
                                    action="{% url 'set_language' %}"
                                    method="post"
                                    style="display: inline"
                                >
                                    {% csrf_token %}
                                    <input
                                        name="next"
                                        type="hidden"
                                        value="{{ request.get_full_path }}"
                                    />
                                    <input
                                        type="hidden"
                                        name="language"
                                        value="ja"
                                    />
                                    <button
                                        type="submit"
                                        class="dropdown-item"
                                        style="
                                            border: none;
                                            background: none;
                                            text-align: left;
                                            width: 100%;
                                            cursor: pointer;
                                        "
                                    >
                                        日本語 (Japanese)
                                    </button>
                                </form>
                            </li>
                            <li>
                                <form
                                    action="{% url 'set_language' %}"
                                    method="post"
                                    style="display: inline"
                                >
                                    {% csrf_token %}
                                    <input
                                        name="next"
                                        type="hidden"
                                        value="{{ request.get_full_path }}"
                                    />
                                    <input
                                        type="hidden"
                                        name="language"
                                        value="vi"
                                    />
                                    <button
                                        type="submit"
                                        class="dropdown-item"
                                        style="
                                            border: none;
                                            background: none;
                                            text-align: left;
                                            width: 100%;
                                            cursor: pointer;
                                        "
                                    >
                                        Tiếng Việt
                                    </button>
                                </form>
                            </li>
                        </ul>
                    </li>
                    <li class="nav-item dropdown">
                        <a
                            href="#"
                            class="nav-link dropdown-toggle"
                            data-toggle="dropdown"
                        >
                            USD
                        </a>
                        <ul class="dropdown-menu small">
                            <li><a class="dropdown-item" href="#">USD</a></li>
                            <li><a class="dropdown-item" href="#">EUR</a></li>
                            <li><a class="dropdown-item" href="#">JPY</a></li>
                            <li><a class="dropdown-item" href="#">VND</a></li>
                        </ul>
                    </li>
                </ul>
                <ul class="navbar-nav">
                    <li>
                        <a href="{% url 'voucher_list' %}" class="nav-link">
                            <i class="fa fa-ticket"></i> {% trans "Vouchers" %}
                        </a>
                    </li>
                    <li>
                        <a href="#" class="nav-link">
                            <i class="fa fa-envelope"></i> {% trans "Email" %}
                        </a>
                    </li>
                    <li>
                        <a href="#" class="nav-link">
                            <i class="fa fa-phone"></i> {% trans "Call us" %}
                        </a>
                    </li>
                    <li class="nav-item">
                        <div class="theme-toggle">
                            <input type="checkbox" id="theme-toggle" />
                            <label for="theme-toggle" class="theme-toggle-label">
                                <i class="fas fa-sun theme-toggle-icon sun"></i>
                                <i class="fas fa-moon theme-toggle-icon moon"></i>
                            </label>
                        </div>
                    </li>
                </ul>
                <!-- list-inline //  -->
            </div>
            <!-- navbar-collapse .// -->
        </div>
        <!-- container //  -->
    </nav>

    <section class="header-main border-bottom">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-lg-2 col-md-3 col-6">
                    <a href="{% url 'home' %}" class="brand-wrap">
                        <img
                            class="logo"
                            src="{% static './images/logo.png' %}"
                        />
                    </a>
                    <!-- brand-wrap.// -->
                </div>
                <div class="col-lg col-sm col-md col-6 flex-grow-0">
                    <div
                        class="category-wrap dropdown d-inline-block float-right"
                    >
                        <button
                            type="button"
                            class="btn btn-primary dropdown-toggle"
                            data-toggle="dropdown"
                        >
                            <i class="fa fa-bars"></i> {% trans "All category" %}
                        </button>
                        <div class="dropdown-menu">
                            <a class="dropdown-item" href="{% url 'store' %}"
                                >{% trans "All Products" %}
                            </a>
                            {% for category in links %}
                            <a
                                class="dropdown-item"
                                href="{{ category.get_url }}"
                                >{{ category.category_name }}
                            </a>
                            {% endfor %}
                        </div>
                    </div>
                    <!-- category-wrap.// -->
                </div>
                <!-- col.// -->
                <a href="{% url 'store' %}" class="btn btn-outline-primary"
                    >{% trans "Store" %}</a
                >
                <div class="col-lg col-md-6 col-sm-12 col">
                    <form
                        action="{% url 'search' %}"
                        class="search"
                        method="GET"
                    >
                        <div class="input-group w-100">
                            <input
                                type="text"
                                class="form-control"
                                style="width: 60%"
                                placeholder="{% trans 'Search' %}"
                                name="keyword"
                            />

                            <div class="input-group-append">
                                <button class="btn btn-primary" type="submit">
                                    <i class="fa fa-search"></i>
                                </button>
                            </div>
                        </div>
                    </form>
                    <!-- search-wrap .end// -->
                </div>
                <!-- col.// -->
                <div class="col-lg-3 col-sm-6 col-8 order-2 order-lg-3">
                    <div class="d-flex justify-content-end mb-3 mb-lg-0">
                        {% if user.id is None %}
                        <div class="widget-header">
                            <small class="title text-muted"
                                >{% trans "Welcome guest!" %}</small
                            >
                            <div>
                                <a href="{% url 'login' %}"
                                    >{% trans "Sign in" %}</a
                                >
                                <span class="dark-transp"> | </span>
                                <a href="{% url 'register' %}">
                                    {% trans "Register" %}</a
                                >
                            </div>
                        </div>
                        {% else %}
                        <div class="widget-header">
                            <small class="title text-muted"
                                >{% trans "Welcome" %}
                                {{user.first_name}}!</small
                            >
                            <div>
                                <a href="{% url 'dashboard' %}"
                                    >{% trans "Dashboard" %}</a
                                >
                                <span class="dark-transp"> | </span>
                                <a href="{% url 'logout' %}">
                                    {% trans "Logout" %}</a
                                >
                            </div>
                        </div>
                        {% endif %}
                        <a
                            href="{% url 'wishlist' %}"
                            class="widget-header pl-2 ml-1"
                            title="{% trans 'My Wishlist' %}"
                        >
                            <div class="icon icon-sm rounded-circle border">
                                <i class="fa fa-heart"></i>
                            </div>
                            <span class="badge badge-pill badge-danger notify wishlist-counter" 
                                  style="{% if wishlist_count == 0 %}display:none;{% endif %}">
                                {{wishlist_count}}
                            </span>
                        </a>
                        <a
                            href="{% url 'cart' %}"
                            class="widget-header pl-2 ml-1"
                        >
                            <div class="icon icon-sm rounded-circle border">
                                <i class="fa fa-shopping-cart"></i>
                            </div>
                            <span class="badge badge-pill badge-danger notify"
                                >{{cart_count}}</span
                            >
                        </a>
                    </div>
                    <!-- widgets-wrap.// -->
                </div>
                <!-- col.// -->
            </div>
            <!-- row.// -->
        </div>
        <!-- container.// -->
    </section>
    <!-- header-main .// -->
</header>
<!-- section-header.// -->
